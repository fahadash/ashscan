namespace ExploitFinder
{
    using System.Collections.Generic;
    using System.Linq;

    using ExploitChecker;

    using Extensibility;

    internal class BlackListedHostExploitFinder : BanListExploitFinder
    {
        public BlackListedHostExploitFinder(string banListFile)
            : base(banListFile)
        {
        }

        public override IEnumerable<Exploit> Run(IUserInfo user)
        {
            // NOTE : should ban.Equals(address) be using a regex? -- Diabolic 15/03/2015
            return this.BanList.Where(ban => ban.Equals(user.Host)).Select(_ => true).Distinct().Select(_ => new Exploit(ExploitType.Banlist_Match));
        }
    }
}