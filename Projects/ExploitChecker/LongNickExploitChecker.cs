using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ExploitChecker
{
    public class LongNickExploitChecker : IExploitChecker
    {
        private int nickLength;

        public LongNickExploitChecker(int nickLength)
            : base()
        {
            this.nickLength = nickLength;
        }

        protected virtual int NickLength
        {
            get
            {
                return this.nickLength;
            }
        }

        public virtual IEnumerable<ExploitType> Check(Func<string> data)
        {
            if (data == null)
            {
                return Enumerable.Empty<ExploitType>();
            }

            var nick = data();

            if (string.IsNullOrEmpty(nick))
            {
                return Enumerable.Empty<ExploitType>();
            }

            return nick.Length >= NickLength ? new[] { ExploitType.Long_Nick_Alert } : Enumerable.Empty<ExploitType>();
        }
    }
}